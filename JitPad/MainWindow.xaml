<controls:BiaWindow x:Class="JitPad.MainWindow"
                    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:avalonedit="http://icsharpcode.net/sharpdevelop/avalonedit"
                    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
                    xmlns:behaviors="clr-namespace:JitPad.Behaviors"
                    xmlns:biaui="clr-namespace:Biaui;assembly=Biaui"
                    xmlns:controls="clr-namespace:Biaui.Controls;assembly=Biaui"
                    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                    xmlns:jitPad="clr-namespace:JitPad"
                    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                    Title="JitPad"
                    Width="1400"
                    Height="1000"
                    MinWidth="800"
                    MinHeight="700"
                    d:DataContext="{d:DesignInstance jitPad:MainWindowViewModel}"
                    AllowDrop="True"
                    DataContextChanged="MainWindow_OnDataContextChanged"
                    Drop="Window_Drop"
                    PreviewDragOver="Window_PreviewDragOver"
                    ShowInTaskbar="True"
                    WindowStartupLocation="CenterScreen"
                    mc:Ignorable="d">
    <controls:BiaWindow.Style>
        <Style BasedOn="{StaticResource BiaWindowDialogStyle}" TargetType="controls:BiaWindow">
            <Setter Property="WindowChrome.WindowChrome">
                <Setter.Value>
                    <WindowChrome CaptionHeight="48"
                                  CornerRadius="{x:Static biaui:Boxes.CornerRadius0}"
                                  GlassFrameThickness="{x:Static biaui:Boxes.Thickness1}"
                                  ResizeBorderThickness="{x:Static biaui:Boxes.Thickness8}" />
                </Setter.Value>
            </Setter>
        </Style>
    </controls:BiaWindow.Style>

    <controls:BiaWindow.Resources>
        <Style x:Key="FilePathTextBoxStyle"
               BasedOn="{StaticResource {x:Type TextBox}}"
               TargetType="{x:Type TextBox}">

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TextBox}">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="{x:Static biaui:Boxes.BasicCornerRadius}"
                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Margin="6,1,26,1"
                                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
                                          Background="Transparent"
                                          HorizontalScrollBarVisibility="{TemplateBinding HorizontalScrollBarVisibility}"
                                          VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </controls:BiaWindow.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <DockPanel Grid.Row="0"
                   Grid.Column="0"
                   Grid.ColumnSpan="3"
                   Margin="12"
                   WindowChrome.IsHitTestVisibleInChrome="True">

            <controls:BiaClippingBorder CornerRadius="4">
                <DockPanel>
                    <controls:BiaToggleButton HorizontalAlignment="Left"
                                              Content="File monitoring"
                                              CornerRadius="0"
                                              DockPanel.Dock="Left"
                                              IsChecked="{Binding IsFileMonitoring.Value, Mode=TwoWay}" />

                    <controls:BiaIconButton Margin="1,0,0,0"
                                            HorizontalAlignment="Right"
                                            Command="{Binding ClearMonitoringFileCommand, Mode=OneTime}"
                                            Content="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
                                            CornerRadius="0"
                                            DockPanel.Dock="Right" />

                    <controls:BiaIconButton HorizontalAlignment="Right"
                                            Command="{Binding OpenMonitoringFileCommand, Mode=OneTime}"
                                            Content="M6.1,10L4,18V8H21A2,2 0 0,0 19,6H12L10,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H19C19.9,20 20.7,19.4 20.9,18.5L23.2,10H6.1M19,18H6L7.6,12H20.6L19,18Z"
                                            CornerRadius="0"
                                            DockPanel.Dock="Right" />

                    <TextBox Width="320"
                             Margin="-4,0"
                             HorizontalAlignment="Left"
                             Panel.ZIndex="-1"
                             IsHitTestVisible="False"
                             IsReadOnly="True"
                             Style="{StaticResource FilePathTextBoxStyle}"
                             Text="{Binding MonitoringFilePath.Value, Mode=TwoWay}" />
                </DockPanel>
            </controls:BiaClippingBorder>

            <controls:BiaToggleSwitch Margin="12,0,0,0"
                                      HorizontalAlignment="Left"
                                      DisabledLabel="Debug"
                                      EnabledLabel="Release"
                                      IsChecked="{Binding IeReleaseBuild.Value, Mode=TwoWay}" />

            <controls:BiaToggleButton Margin="12,0,0,0"
                                      HorizontalAlignment="Left"
                                      Content="Tiered JIT"
                                      IsChecked="{Binding IsTieredJit.Value, Mode=TwoWay}" />
        </DockPanel>

        <Rectangle Grid.Row="0"
                   Grid.Column="0"
                   Grid.ColumnSpan="3"
                   Height="1"
                   VerticalAlignment="Bottom"
                   Stroke="{StaticResource AccentBrushKey.Dark}"
                   StrokeThickness="1" />

        <avalonedit:TextEditor Grid.Row="1"
                               Grid.Column="0"
                               SyntaxHighlighting="C#">
            <b:Interaction.Behaviors>
                <behaviors:TextEditorBindableTextBehavior Text="{Binding SourceCode.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                <behaviors:TextEditorCompletionBehavior />
                <behaviors:SourceCodeTextEditorBehavior BuildDetailMessages="{Binding BuildDetailMessage.Value, Mode=OneWay}" />
            </b:Interaction.Behaviors>
        </avalonedit:TextEditor>

        <avalonedit:TextEditor Grid.Row="1"
                               Grid.Column="2"
                               IsReadOnly="True"
                               ShowLineNumbers="False"
                               SyntaxHighlighting="Asm"
                               WordWrap="True">
            <b:Interaction.Behaviors>
                <behaviors:TextEditorBindableTextBehavior Text="{Binding BuildResult.Value, Mode=OneWay}" />
            </b:Interaction.Behaviors>

            <avalonedit:TextEditor.Style>
                <Style BasedOn="{StaticResource {x:Type avalonedit:TextEditor}}" TargetType="avalonedit:TextEditor">
                    <Setter Property="Visibility" Value="Hidden" />

                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsBuildOk.Value, Mode=OneWay}" Value="True">
                            <Setter Property="Visibility" Value="Visible" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </avalonedit:TextEditor.Style>
        </avalonedit:TextEditor>

        <avalonedit:TextEditor Grid.Row="1"
                               Grid.Column="2"
                               IsReadOnly="True"
                               ShowLineNumbers="False"
                               SyntaxHighlighting="BUILD_MSG"
                               WordWrap="True">
            <b:Interaction.Behaviors>
                <behaviors:TextEditorBindableTextBehavior Text="{Binding BuildMessage.Value, Mode=OneWay}" />
            </b:Interaction.Behaviors>

            <avalonedit:TextEditor.Style>
                <Style BasedOn="{StaticResource {x:Type avalonedit:TextEditor}}" TargetType="avalonedit:TextEditor">
                    <Setter Property="Visibility" Value="Visible" />

                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsBuildOk.Value, Mode=OneWay}" Value="True">
                            <Setter Property="Visibility" Value="Hidden" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </avalonedit:TextEditor.Style>
        </avalonedit:TextEditor>

        <controls:BiaProgressPanel Grid.Row="1"
                                   Grid.Column="2"
                                   VerticalAlignment="Top">
            <controls:BiaProgressPanel.Style>
                <Style TargetType="controls:BiaProgressPanel">
                    <Setter Property="Visibility" Value="Hidden" />

                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsInProcessing.Value, Mode=OneWay}" Value="True">
                            <Setter Property="Visibility" Value="Visible" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </controls:BiaProgressPanel.Style>
        </controls:BiaProgressPanel>

        <Rectangle Grid.Row="1"
                   Grid.Column="1"
                   Width="1"
                   HorizontalAlignment="Center"
                   Stroke="{StaticResource AccentBrushKey.Dark}"
                   StrokeThickness="1" />

        <GridSplitter Grid.Row="1"
                      Grid.Column="1"
                      Width="12"
                      Margin="-12,0"
                      ResizeDirection="Columns" />
    </Grid>
</controls:BiaWindow>